<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pathfinding Visualizer - Interactive Algorithm Visualization</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://path-visualizer-crypticsy.vercel.app/tiles.ico" />
    <link rel="shortcut icon" type="image/x-icon" href="https://path-visualizer-crypticsy.vercel.app/tiles.ico" />

    <!-- Meta Tags for SEO and Social -->
    <meta name="description" content="Interactive visualization of pathfinding algorithms on a customizable grid. Supports A*, Dijkstra, BFS, DFS, Greedy Best-First, Bidirectional A*, and Jump Point Search with drag-and-drop interface."/>
    <meta name="keywords" content="pathfinding, visualization, algorithms, a-star, dijkstra, bfs, dfs, maze, interactive"/>
    <meta name="robots" content="index,follow"/>
    <meta name="author" content="Crypticsy"/>

    <!-- Open Graph -->
    <meta property="og:title" content="Pathfinding Visualizer"/>
    <meta property="og:description" content="Interactive visualization of pathfinding algorithms with drag-and-drop interface and Nord Light theme."/>
    <meta property="og:image" content="https://path-visualizer-crypticsy.vercel.app/thumbnail.png"/>
    <meta property="og:url" content="https://path-visualizer-crypticsy.vercel.app/"/>
    <meta property="og:type" content="website"/>

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="Pathfinding Visualizer"/>
    <meta name="twitter:description" content="Interactive visualization of pathfinding algorithms with drag-and-drop interface."/>
    <meta name="twitter:image" content="https://path-visualizer-crypticsy.vercel.app/thumbnail.png"/>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Figtree:wght@300;400;500;600;700;800&family=Roboto+Mono&display=swap" rel="stylesheet">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/output.css') }}">
</head>

<body class="overflow-hidden">
    <!-- Main Full-Screen Layout -->
    <div class="app-container">
        <!-- Header with All Controls -->
        <header class="navbar">
            <div class="navbar-content">
                <!-- Left: Title -->
                <div class="navbar-section">
                    <h1 class="navbar-title">Pathfinding Visualizer</h1>
                </div>

                <!-- Center: Controls -->
                <div class="navbar-section navbar-controls">
                    <!-- Grid Size -->
                    <div class="control-group">
                        <label class="control-label">Grid</label>
                        <div class="grid-size-inline">
                            <input type="number" id="gridRows" class="grid-input" min="10" max="50" value="15">
                            <span class="grid-x">Ã—</span>
                            <input type="number" id="gridCols" class="grid-input" min="10" max="50" value="15">
                            <button id="applyGridSize" class="apply-btn" title="Apply grid size">
                                <i data-lucide="check"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Algorithm -->
                    <div class="control-group">
                        <label class="control-label">Algorithm</label>
                        <select id="algorithmSelect" class="control-select">
                            <option value="astar">A* Search</option>
                            <option value="dijkstra">Dijkstra</option>
                            <option value="bfs">Breadth-First Search</option>
                            <option value="dfs">Depth-First Search</option>
                            <option value="greedy">Greedy Best-First</option>
                            <option value="bidirectional">Bidirectional A*</option>
                            <option value="jps">Jump Point Search</option>
                        </select>
                    </div>

                    <!-- Speed -->
                    <div class="control-group">
                        <label class="control-label">Speed</label>
                        <div class="speed-control">
                            <i data-lucide="gauge" class="speed-icon"></i>
                            <input type="range" id="speedSlider" class="speed-slider" min="10" max="200" value="150" step="10">
                            <span class="speed-label" id="speedLabel">Medium</span>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="control-group">
                        <div class="action-buttons">
                            <button id="runBtn" class="nav-btn nav-btn-primary" data-tooltip="Visualize Path">
                                <i data-lucide="play"></i>
                                <span>Visualize</span>
                            </button>
                            <button id="generateMazeBtn" class="nav-btn nav-btn-secondary" data-tooltip="Generate Maze">
                                <i data-lucide="grid-3x3"></i>
                            </button>
                            <button id="clearPathBtn" class="nav-btn nav-btn-secondary" data-tooltip="Clear Path">
                                <i data-lucide="eraser"></i>
                            </button>
                            <button id="clearWallsBtn" class="nav-btn nav-btn-secondary" data-tooltip="Clear Walls">
                                <i data-lucide="trash-2"></i>
                            </button>
                            <button id="resetBtn" class="nav-btn nav-btn-danger" data-tooltip="Reset Grid">
                                <i data-lucide="rotate-ccw"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right: Stats & Info -->
                <div class="navbar-section navbar-right">
                    <!-- Stats -->
                    <div class="stats-inline">
                        <div class="stat-inline" data-tooltip="Nodes Visited">
                            <i data-lucide="eye" class="stat-icon"></i>
                            <span id="nodesVisited" class="stat-value">0</span>
                        </div>
                        <div class="stat-inline" data-tooltip="Path Length">
                            <i data-lucide="route" class="stat-icon"></i>
                            <span id="pathLength" class="stat-value">0</span>
                        </div>
                        <div class="stat-inline" data-tooltip="Time Taken">
                            <i data-lucide="clock" class="stat-icon"></i>
                            <span id="timeTaken" class="stat-value">0ms</span>
                        </div>
                    </div>

                    <!-- Info Button -->
                    <button id="infoBtn" class="icon-btn" title="How to use">
                        <i data-lucide="info"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Grid Area (Full Screen) -->
        <main class="grid-container">
            <div id="pathGrid" class="path-grid"></div>
        </main>
    </div>

    <!-- Footer Credit (Fixed at Bottom Center) -->
    <footer class="footer-credit">
        <p class="footer-text">
            <span class="footer-created">Created by </span>
            <a
                href="https://www.animeshbasnet.com.np/"
                target="_blank"
                rel="noopener noreferrer"
                class="footer-link"
            >
                Crypticsy
                <img
                    src="https://github.com/crypticsy.png"
                    alt="Crypticsy"
                    class="footer-avatar"
                />
            </a>
        </p>
    </footer>

    <!-- Info Modal -->
    <div id="infoModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">How to Use</h2>
                <button id="closeModal" class="icon-btn">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="instruction-list">
                    <div class="instruction-item-new">
                        <div class="instruction-number">1</div>
                        <div>
                            <h3 class="instruction-title">Adjust Grid Size</h3>
                            <p class="instruction-text">Set rows and columns (10-50), then click the check button to apply.</p>
                        </div>
                    </div>
                    <div class="instruction-item-new">
                        <div class="instruction-number">2</div>
                        <div>
                            <h3 class="instruction-title">Position Start & End</h3>
                            <p class="instruction-text">Drag the green start tile and red end tile to set positions.</p>
                        </div>
                    </div>
                    <div class="instruction-item-new">
                        <div class="instruction-number">3</div>
                        <div>
                            <h3 class="instruction-title">Draw Walls</h3>
                            <p class="instruction-text">Click and drag on empty cells to draw walls. Click walls to erase.</p>
                        </div>
                    </div>
                    <div class="instruction-item-new">
                        <div class="instruction-number">4</div>
                        <div>
                            <h3 class="instruction-title">Select Algorithm</h3>
                            <p class="instruction-text">Choose from A*, Dijkstra, BFS, DFS, and more.</p>
                        </div>
                    </div>
                    <div class="instruction-item-new">
                        <div class="instruction-number">5</div>
                        <div>
                            <h3 class="instruction-title">Visualize</h3>
                            <p class="instruction-text">Click "Visualize" to watch the algorithm. Adjust animation speed with the slider.</p>
                        </div>
                    </div>
                </div>
                <div class="keyboard-shortcuts">
                    <h3 class="shortcuts-title">Keyboard Shortcuts</h3>
                    <div class="shortcuts-grid">
                        <div class="shortcut-item">
                            <kbd>Space</kbd>
                            <span>Run algorithm</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>C</kbd>
                            <span>Clear path</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>G</kbd>
                            <span>Generate maze</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>R</kbd>
                            <span>Reset grid</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='js/grid.js') }}"></script>
    <script src="{{ url_for('static', filename='js/controls.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>

    <!-- Initialize Lucide Icons -->
    <script>
        lucide.createIcons();

        // Update speed label (reversed: low value = slow, high value = fast)
        const speedSlider = document.getElementById('speedSlider');
        const speedLabel = document.getElementById('speedLabel');

        function updateSpeedLabel(value) {
            const speed = parseInt(value);
            // Reversed logic: higher slider value = faster
            if (speed >= 170) speedLabel.textContent = 'Very Fast';
            else if (speed >= 130) speedLabel.textContent = 'Fast';
            else if (speed >= 80) speedLabel.textContent = 'Medium';
            else speedLabel.textContent = 'Slow';
        }

        if (speedSlider && speedLabel) {
            speedSlider.addEventListener('input', (e) => updateSpeedLabel(e.target.value));
            updateSpeedLabel(speedSlider.value);
        }

        // Tooltip functionality
        const tooltipElements = document.querySelectorAll('[data-tooltip]');
        const tooltip = document.createElement('div');
        tooltip.className = 'custom-tooltip';
        document.body.appendChild(tooltip);

        tooltipElements.forEach(element => {
            element.addEventListener('mouseenter', (e) => {
                const text = e.currentTarget.getAttribute('data-tooltip');
                tooltip.textContent = text;
                tooltip.classList.add('visible');

                const rect = e.currentTarget.getBoundingClientRect();
                tooltip.style.left = rect.left + (rect.width / 2) - (tooltip.offsetWidth / 2) + 'px';
                tooltip.style.top = rect.bottom + 8 + 'px';
            });

            element.addEventListener('mouseleave', () => {
                tooltip.classList.remove('visible');
            });
        });
    </script>
</body>
</html>
